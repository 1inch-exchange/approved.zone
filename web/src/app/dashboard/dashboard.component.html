<div class="container mt-2 mt-md-5 p-3">

    <app-loading-spinner *ngIf="loading"></app-loading-spinner>

    <form #f="ngForm" *ngIf="!loading" class="col-12 col-md-8 ml-auto mr-auto mb-1" novalidate>

        <div class="form-row">
            <div class="form-group col-8 ml-auto mr-auto">

                <input [formControl]="walletAddressControl"
                       class="form-control text-center" id="walletAddress"
                       name="walletAddress" placeholder="Ethereum Wallet Address"
                       type="text">
            </div>
        </div>
    </form>

    <div *ngIf="!loading && walletAddress !== ''">
        <div class="row border-bottom mb-3 pb-3 mt-5">
            <div class="col-4" style="white-space: nowrap;overflow: hidden;text-overflow: ellipsis; font-size: 1.3rem;">
                Smart Contract
            </div>
            <div class="col-8">
                <div class="row">
                    <div class="col-6"
                         style="white-space: nowrap;overflow: hidden;text-overflow: ellipsis; font-size: 1.3rem;">
                        Token
                    </div>
                    <div class="col-4" [className]="!hasWeb3Provider ? 'col-6' : 'col-4'"
                         style="text-align: center; white-space: nowrap;overflow: hidden;text-overflow: ellipsis; font-size: 1.3rem;">
                        Allowance
                    </div>
                    <div class="col-2" *ngIf="hasWeb3Provider"
                         style="text-align: center; white-space: nowrap;overflow: hidden;text-overflow: ellipsis; font-size: 1.3rem;">
                        Action
                    </div>
                </div>
            </div>
        </div>
        <div *ngFor="let item of approves" class="row border-bottom mb-3 pb-3">
            <div class="col-4" style="white-space: nowrap;overflow: hidden;text-overflow: ellipsis; font-size: 0.8rem;">
                <a [href]="'https://etherscan.io/address/' + item.address" target="_blank">
                    {{item.address}}
                </a>
            </div>
            <div class="col-8">
                <div *ngFor="let approval of item.approvals" class="row border-bottom pb-3 mb-2">
                    <div class="col-6" style="white-space: nowrap;overflow: hidden;text-overflow: ellipsis;">
                        <a [href]="'https://etherscan.io/address/' + approval.tokenAddress"
                           [title]="approval.tokenAddress" style="color: #fdc100;" target="_blank">
                            <img
                                [alt]="approval.symbol"
                                [src]="'https://1inch.exchange/assets/tokens/' + approval.tokenAddress.toLowerCase() + '.png'"
                                class="mr-1"
                                onerror="this.src = 'https://1inch.exchange/assets/tokens/token.png';"
                                width="32">
                            {{approval.symbol}}
                        </a>
                        <div class="text-secondary mt-2" style="font-size: 0.8rem;">
                            {{approval.tokenAddress}}
                        </div>
                    </div>
                    <div [className]="!hasWeb3Provider ? 'col-6' : 'col-4'" style="text-align: center; white-space: nowrap;overflow: hidden;text-overflow: ellipsis;">
                        {{approval.formatedAllowance}}
                    </div>
                    <div class="col-2" *ngIf="hasWeb3Provider" style="text-align: center;">
                        <button (click)="decline(approval)" *ngIf="hasWeb3Provider" class="btn btn-danger btn-sm ml-1">
                            Decline
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
